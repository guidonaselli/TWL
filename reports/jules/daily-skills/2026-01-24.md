# Daily Skills Report - 2026-01-24

## Focus
Special Skills Infrastructure & Goddess Skills (GS) Implementation.

## Design Changes
- **Skill Schema Expansion**:
  - Added `SkillFamily` (Core vs Special).
  - Added `SkillCategory` (RebirthJob, ElementSpecial, Fairy, Dragon, Griffin, Goddess).
  - Added `SkillRestrictions` (UniquePerCharacter, BindOnAcquire, NotTradeable, NotDropable, RebirthClassRequirement).
  - Added `SkillHitRules` (BaseChance, StatDependence, Min/Max Chance) for control skills.
  - Added `DisplayNameKey` for localization support.
  - Added `QuestFlag` to `UnlockRules` for server-side gating.

## Implementation Status
- **Schema**: Updated `Skill.cs`, `SkillEnums.cs`. Created `SkillHitRules.cs`, `SkillRestrictions.cs`.
- **Data**:
  - Updated `skills.json` with new fields (defaults for Core skills).
  - Added 4 Goddess Skills:
    - **Shrink** (Water, Special, Goddess) - Debuff Atk.
    - **Blockage** (Earth, Special, Goddess) - Seal (Control).
    - **Hotfire** (Fire, Special, Goddess) - High Damage.
    - **Vanish** (Wind, Special, Goddess) - Self Buff (Spd/Eva).
- **Engine Logic**:
  - Updated `ServerCharacter` to support `StatusEffects` (Add, Remove, Cleanse, Dispel).
  - Updated `CombatManager` (server-side) to implement `HitRules` and apply `Effects` (Status Effects, Cleanse, Dispel).
  - Updated `BattleInstance` (shared) to use `Skill.HitRules` in simulation.
  - Updated `CombatResult` to include `AddedEffects`.
- **Tests**:
  - Added `SpecialSkillTests.cs` verifying JSON deserialization and property mapping.
  - Added `CombatManager_ApplySeal_UsesHitRules` test to verify Control logic and HitChance calculation using Mock RNG.
  - Verified `JsonStringEnumConverter` handles new Enums correctly.

## Blockers / Known Issues
- `TWL.Tests.Domain.Skills.SkillSystemTests.TestFireballSkill_LoadedFromJson_AndExecuted` is currently failing (pre-existing issue related to damage calculation/mocking).
- Rebirth Class logic is defined in schema but `PlayerCharacter` support for Rebirth Class is pending (currently only generic Rebirth exists).
- `QuestFlag` enforcement for skill learning is not yet implemented (requires locating the learning hook or adding `LearnSkill` opcode handler).

## Next Steps
- Implement `PlayerQuestComponent` logic to enforce `QuestFlag` on skill learning.
- Implement Rebirth Class selection in `PlayerCharacter`.
