# Daily Architecture Report - 2024-10-23

## Diagnosis
**Pain Point:** `CombatManager` contained hardcoded damage calculation logic (`Str * 2`, `+/- 5%` variance) and directly depended on `IRandomService`. This violated the Single Responsibility Principle and made testing combat mechanics in isolation difficult. It also hindered future extensibility (e.g., adding different damage formulas).

## Proposed Solution (Implemented)
**Extract `ICombatResolver` Service:**
1. Defined `ICombatResolver` interface with `CalculateDamage` method.
2. Implemented `StandardCombatResolver` encapsulating the existing logic and `IRandomService` dependency.
3. Refactored `CombatManager` to depend on `ICombatResolver` via constructor injection.
4. Updated `GameServer` to wire up the dependencies.
5. Added unit tests for `StandardCombatResolver` using `MockRandomService`.

## Impact
- **Decoupling:** `CombatManager` is now responsible for flow/state, while `ICombatResolver` handles calculation.
- **Testability:** Damage logic can be tested in isolation (verified by `CombatResolverTests`).
- **Extensibility:** New damage formulas can be implemented by swapping the resolver implementation without modifying `CombatManager`.
- **Risk:** Minimal (surgical change, covered by tests).

## Verification
- Built and ran tests: 97 passed (including new `CombatResolverTests`).
- Verified integration tests `QuestCombatIntegrationTests` passed.
