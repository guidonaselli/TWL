# Daily Reliability Report - 2026-02-06

**Author:** Jules
**Focus:** Reliability, Persistence & Observability (Health Checks + Graceful Shutdown)

## Deliverables
1.  **Enhanced Health Checks**: `HealthCheckService` now reports:
    -   App Version
    -   Uptime
    -   Active Player Count
    -   Dirty Session Count
    -   World Loop Drift
    -   Skipped Ticks
2.  **Graceful Shutdown Telemetry**: Verified orchestration of network stop -> player disconnect -> save -> shutdown.
3.  **Metrics**: Added `StartTime` and `LastPersistenceFlushTime` to `ServerMetrics`.

## Evidence
-   **Tests**:
    -   `HealthCheckTests.ExecuteAsync_ShouldWriteHealthJson`: Verified JSON structure and content.
    -   `GracefulShutdownTests.StopAsync_ShouldDisconnectPlayersAndStopServices`: Verified shutdown sequence.
-   **Fixes**:
    -   Fixed `SpawnManagerTests` (Random setup for mob count was returning 0, preventing encounter start).
    -   Fixed `TestClientSession` (Shadow property for `Character` was missing).
    -   Fixed `PlayerQuestComponent` (Variable scoping bug in `HandleMapChanged`).
    -   Fixed `ClientSession` (Missing `SendLoginError` method).

## Metrics
-   `health.json` now provides a complete snapshot of server health for external monitoring (watchdog/k8s).
